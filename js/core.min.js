!function(e){var t={};function o(r){if(t[r])return t[r].exports;var l=t[r]={i:r,l:!1,exports:{}};return e[r].call(l.exports,l,l.exports,o),l.l=!0,l.exports}o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)o.d(r,l,function(t){return e[t]}.bind(null,l));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=4)}([function(e,t,o){"use strict";const{__:r}=wp.i18n,l=wp.element.Component,{Dashicon:a,DateTimePicker:n,Dropdown:i}=wp.components,{dateI18n:s,__experimentalGetSettings:c}=wp.date;class u extends l{constructor(){super(...arguments)}updateKey(e){let t=this.props.rule;t.key=e,t.operator=this.getDefaultOperator(),t.value="",this.props.updateRule(t,this.props.index)}updateOperator(e){let t=this.props.rule;t.operator=e,this.props.updateRule(t,this.props.index)}updateValue(e){let t=this.props.rule;t.value=e,this.props.updateRule(t,this.props.index)}getDefaultOperator(){let e=this.getOperators().map(e=>e.value);return e.includes(this.props.rule.operator)?this.props.rule.operator:e[0]}getOperators(){let{key:e}=this.props.rule,t=gform_block_core.conditionalOptions;for(let o=0;o<t.length;o++)if(t[o].key.value===e||!e)return t[o].operators;return[]}getValue(){let{key:e}=this.props.rule,t=gform_block_core.conditionalOptions;for(let o=0;o<t.length;o++)if(t[o].key.value===e||!e)return t[o].value;return[]}getValueInput(){let{value:e}=this.props.rule;const t=this.props.index,o=c(),l=e=>this.updateValue(e.target.value);switch(this.getValue().type){case"date":const a=e=>this.updateValue(e),c=/a(?!\\)/i.test(o.formats.time.toLowerCase().replace(/\\\\/g,"").split("").reverse().join(""));return React.createElement(i,{key:`gform-block__conditional-rule-${t}-value`,position:"bottom left",contentClassName:"gform-block__conditional-rule-value-popover",className:"gform-block__conditional-rule-value",renderToggle:({onToggle:t,isOpen:l})=>React.createElement("button",{type:"button",className:"button-link",onClick:t,"aria-expanded":l},e?s(o.formats.datetime,e):r("Select a Date","gravityforms")),renderContent:()=>[React.createElement(n,{key:"date-time-picker",currentDate:e,onChange:a,locale:o.l10n.locale,is12Hour:c})]});case"select":return React.createElement("select",{key:`gform-block__conditional-rule-${t}-value`,className:"gform-block__conditional-rule-value",value:e,onChange:l},this.getValue().choices.map(function(e){if(e.choices){let t=e.choices.map(e=>React.createElement("option",{key:e.value,value:e.value},e.label));return React.createElement("optgroup",{label:e.label,key:e.label},t)}return React.createElement("option",{key:e.value,value:e.value},e.label)}));default:return React.createElement("input",{key:`gform-block__conditional-rule-${t}-value`,className:"gform-block__conditional-rule-value",value:e,onChange:l})}}render(){let{key:e,operator:t}=this.props.rule;const o=this.props.index,r=this.props.options,l=React.createElement("select",{key:`gform-block__conditional-rule-${o}-key`,className:"gform-block__conditional-rule-key",value:e,onChange:e=>this.updateKey(e.target.value)},r.map(e=>React.createElement("option",{key:e.key.value,value:e.key.value},e.key.label))),n=React.createElement("select",{key:`gform-block__conditional-rule-${o}-operator`,className:"gform-block__conditional-rule-operator",value:t,onChange:e=>this.updateOperator(e.target.value)},this.getOperators().map(e=>React.createElement("option",{key:e.value,value:e.value},e.label)));return React.createElement("div",{className:"gform-block__conditional-rule"},React.createElement("div",{className:"gform-block__conditional-rule-inputs"},l,n,this.getValueInput()),React.createElement("div",{className:"gform-block__conditional-rule-controls"},React.createElement("span",{className:"gform-block__conditional-rule-delete",onClick:()=>this.props.deleteRule(o)},React.createElement(a,{key:`gform-block__conditional-rule-delete-${o}`,icon:"trash"}))))}}const{__:p}=wp.i18n,m=wp.element.Component,{IconButton:g}=wp.components;class d extends m{constructor(){super(...arguments),this.addRule=this.addRule.bind(this),this.deleteRule=this.deleteRule.bind(this),this.updateRule=this.updateRule.bind(this)}addRule(){let e=[...this.getRules(),this.getDefaultOption()];this.setRules(e)}deleteRule(e){let t=this.getRules();t.splice(e,1),this.setRules(t)}getRules(){return this.props.rules}setRules(e){this.props.onChange(e)}updateRule(e,t){let o=this.getRules();o[t]=e,this.props.onChange(o)}getOptions(){return gform_block_core.conditionalOptions}getDefaultOption(){let e=this.getOptions()[0];return{key:e.key.value,operator:e.operators[0].value,value:e.value.choices?e.value.choices[0].choices?e.value.choices[0].choices[0].value:e.value.choices[0].value:""}}render(){let e=this.props.rules,t=this.getOptions();return[e&&e.map((e,o)=>React.createElement(u,{options:t,rule:e,key:`gform-block__conditional-rule-${o}`,index:o,updateRule:this.updateRule,deleteRule:this.deleteRule})),React.createElement("div",{className:"gform-block__conditional-rule-add"+(e&&0!=e.length?"":" no-rules"),key:"gform-block__conditional-rule-add"},React.createElement(g,{icon:"insert",label:p("Add Rule"),onClick:this.addRule,className:"editor-inserter__toggle"},!e||0==e.length&&React.createElement("span",null,"Add Rule")))]}}o.d(t,"a",function(){return k});const{__:f}=wp.i18n,{Component:h}=wp.element,{Button:b,Popover:v,RadioControl:y}=wp.components;class k extends h{constructor(){super(...arguments),this.state={visible:{actionType:!1,logicType:!1}}}getActionTypes(){return[{label:f("Show","gravityforms"),value:"show"},{label:f("Hide","gravityforms"),value:"hide"}]}getActionTypeLabel(e="show"){return this.getActionTypes().filter(t=>t.value===e)[0].label}getLogicTypes(){return[{label:f("all","gravityforms"),value:"all"},{label:f("any","gravityforms"),value:"any"}]}getLogicTypeLabel(e="all"){return this.getLogicTypes().filter(t=>t.value===e)[0].label}render(){let{actionType:e,logicType:t,rules:o}=this.props.logic;const r=this.getActionTypes(),l=this.getLogicTypes(),a=()=>this.setState({visible:{actionType:!this.state.visible.actionType}}),n=()=>this.setState({visible:{logicType:!this.state.visible.logicType}});return React.createElement("div",null,React.createElement("div",{className:"gform-block__conditional-type"},React.createElement(b,{className:"button-link",onClick:a},React.createElement("div",null,this.getActionTypeLabel(e)),this.state.visible.actionType&&React.createElement(v,{onClose:a,position:"bottom",className:"gform-block__conditional-popover"},React.createElement(y,{options:r,onChange:e=>this.props.onChange({actionType:e}),selected:e})))," form if ",React.createElement(b,{className:"button-link",onClick:n},React.createElement("div",null,this.getLogicTypeLabel(t)),this.state.visible.logicType&&React.createElement(v,{onClose:n,position:"bottom",className:"gform-block__conditional-popover"},React.createElement(y,{options:l,onChange:e=>this.props.onChange({logicType:e}),selected:t})))," rules match"),React.createElement(d,{key:"gform-block__conditional-ruleset",rules:o,onChange:e=>{this.props.onChange({rules:e})}}))}}},,function(e,t,o){},,function(e,t,o){"use strict";o.r(t);o(2);var r=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 508.3 559.5",width:"100%",height:"100%",focusable:"false","aria-hidden":"true",className:"dashicon dashicon-gravityforms"},React.createElement("g",null,React.createElement("path",{className:"st0",d:"M468,109.8L294.4,9.6c-22.1-12.8-58.4-12.8-80.5,0L40.3,109.8C18.2,122.6,0,154,0,179.5V380\tc0,25.6,18.1,56.9,40.3,69.7l173.6,100.2c22.1,12.8,58.4,12.8,80.5,0L468,449.8c22.2-12.8,40.3-44.2,40.3-69.7V179.6\tC508.3,154,490.2,122.6,468,109.8z M399.3,244.4l-195.1,0c-11,0-19.2,3.2-25.6,10c-14.2,15.1-18.2,44.4-19.3,60.7H348v-26.4h49.9\tv76.3H111.3l-1.8-23c-0.3-3.3-5.9-80.7,32.8-121.9c16.1-17.1,37.1-25.8,62.4-25.8h194.7V244.4z"}))),l=o(0),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e};const{__:n}=wp.i18n,{PanelBody:i,Placeholder:s,SelectControl:c,ServerSideRender:u,TextControl:p,ToggleControl:m}=wp.components,{InspectorControls:g}=wp.editor,{Component:d,RawHTML:f}=wp.element;var h=class extends d{constructor(){super(...arguments),this.setFormId=this.setFormId.bind(this);let e=this.getForm(this.props.attributes.formId);e&&e.hasConditionalLogic&&this.props.setAttributes({formPreview:!1})}componentWillUnmount(){this.unmounting=!0}setFormId(e){let t=this.getForm(e);this.props.setAttributes({formId:e}),t&&t.hasConditionalLogic&&this.props.setAttributes({formPreview:!1})}getForm(e){return gform_block_core.forms.find(t=>t.id==e)}getFormOptions(){let e=[{label:n("Select a Form","gravityformsgutenberg"),value:""}];for(let t=0;t<gform_block_core.forms.length;t++)e.push({label:gform_block_core.forms[t].title,value:gform_block_core.forms[t].id});return e}render(){let{formId:e,title:t,description:o,ajax:d,tabindex:f,formPreview:h,conditionalLogic:b}=this.props.attributes;const{setAttributes:v,isSelected:y}=this.props,k=e=>this.setFormId(e.target.value),_=[y&&React.createElement(g,{key:"inspector"},React.createElement(i,{title:n("Form Settings","gravityformsgutenberg")},React.createElement(c,{label:n("Form","gravityformsgutenberg"),value:e,options:this.getFormOptions(),onChange:this.setFormId}),React.createElement(m,{label:n("Form Title","gravityformsgutenberg"),checked:t,onChange:()=>v({title:!t})}),React.createElement(m,{label:n("Form Description","gravityformsgutenberg"),checked:o,onChange:()=>v({description:!o})})),React.createElement(i,{title:n("Conditional Logic","gravityformsgutenberg"),className:"gform-block__panel"},React.createElement(m,{label:n("Conditional Logic","gravityformsgutenberg"),checked:b.enabled,onChange:()=>v({conditionalLogic:a({},b,{enabled:!b.enabled})})}),b.enabled&&React.createElement(l.a,{key:"gform-block__conditional",logic:b,onChange:e=>v({conditionalLogic:a({},b,e)})})),React.createElement(i,{title:n("Advanced","gravityformsgutenberg"),initialOpen:!1,className:"gform-block__panel"},e&&!this.getForm(e).hasConditionalLogic&&React.createElement(m,{label:n("Preview","gravityformsgutenberg"),checked:h,onChange:()=>v({formPreview:!h})}),React.createElement(m,{label:n("AJAX","gravityformsgutenberg"),checked:d,onChange:()=>v({ajax:!d})}),React.createElement(p,{label:n("Tabindex","gravityformsgutenberg"),value:f,onChange:e=>v({tabindex:e}),placeholder:"-1"})))];return e&&h?[_,React.createElement(u,{key:"form_preview",block:"gravityforms/block",attributes:this.props.attributes})]:[_,React.createElement(s,{key:"placeholder",className:"wp-block-embed gform-block__placeholder"},React.createElement("div",{className:"gform-block__placeholder-brand"},React.createElement("div",{className:"gform_icon"},r),React.createElement("p",null,React.createElement("strong",null,"Gravity Forms"))),gform_block_core.forms&&gform_block_core.forms.length>0&&React.createElement("form",null,React.createElement("select",{value:e,onChange:k},this.getFormOptions().map(e=>React.createElement("option",{key:e.value,value:e.value},e.label)))),(!gform_block_core.forms||gform_block_core.forms&&0===gform_block_core.forms.length)&&React.createElement("form",null,React.createElement("p",null,n("You must have at least one form to use the block.","gravityforms"))))]}};const{__:b}=wp.i18n,{createBlock:v,registerBlockType:y}=wp.blocks;y("gravityforms/block",{title:b("Form (Experimental)","gravityformsgutenberg"),description:b("Select a form below to add it to your page.","gravityformsgutenberg"),category:"embed",supports:{customClassName:!1,className:!1,html:!1},keywords:["gravity forms"],attributes:{formId:{type:"string"},title:{type:"bool",default:!0},description:{type:"bool",default:!0},ajax:{type:"bool",default:!1},conditionalLogic:{type:"object",default:{enabled:!1,actionType:"show",logicType:"all",rules:[]}},tabindex:{type:"string"},formPreview:{type:"bool",default:!0}},icon:r,transforms:{from:[{type:"block",blocks:["gravityforms/form"],transform:e=>v("gravityforms/block",{formId:e.formId,title:e.title,description:e.description,ajax:e.ajax,tabindex:e.tabindex,formPreview:e.formPreview})}],to:[{type:"block",blocks:["gravityforms/form"],transform:e=>v("gravityforms/form",{formId:e.formId,title:e.title,description:e.description,ajax:e.ajax,tabindex:e.tabindex,formPreview:e.formPreview})}]},edit:h,save:function(e){let{formId:t,title:o,description:r,ajax:l,tabindex:a}=e.attributes;return t?{shortcode:`[gravityform id="${t}" title="${o?"true":"false"}" description="${r?"true":"false"}" ajax="${l?"true":"false"}" tabindex="${a||0}"]`}:null}})}]);